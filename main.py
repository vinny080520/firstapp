import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go

# -----------------------------
# 1. í˜ì´ì§€ ì„¤ì • ë° ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
# -----------------------------
st.set_page_config(page_title="ê¸°ì˜¨ ì´ìƒì¹˜ ë°œí‘œ ìŠ¬ë¼ì´ë“œ", layout="wide")
st.title("ğŸŒ ì§€êµ¬ ì˜¨ë‚œí™”: ê¸°ì˜¨ ì´ìƒì¹˜ ë°œí‘œ ìë£Œ")

@st.cache_data
def load_data():
    return pd.read_csv("zonann_temps.csv")

df = load_data()

# -----------------------------
# 2. ìŠ¬ë¼ì´ë“œ ì„ íƒ (1~7)
# -----------------------------
slide = st.slider("ìŠ¬ë¼ì´ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”", 1, 7, 1)
st.markdown(f"### â–¶ï¸ í˜„ì¬ ìŠ¬ë¼ì´ë“œ: **{slide}/7**")

# -----------------------------
# 3. (1~6 ìŠ¬ë¼ì´ë“œ ê¸°ì¡´ ë‚´ìš© ìƒëµ)
# -----------------------------
# ê¸°ì¡´ ìŠ¬ë¼ì´ë“œ 1~6 ì½”ë“œëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€

# -----------------------------
# 4. âœ… ìŠ¬ë¼ì´ë“œ 7: IPCC AR6 ê¸°ë°˜ ë¯¸ë˜ ì˜ˆì¸¡
# -----------------------------
if slide == 7:
    st.header("ğŸ“ˆ ë¯¸ë˜ ê¸°ì˜¨ ì´ìƒì¹˜ ì˜ˆì¸¡ (IPCC AR6 ê¸°ë°˜)")
    st.markdown("""
    **ì¶œì²˜**: [IPCC AR6, WGI, Summary for Policymakers (2021)](https://www.ipcc.ch/report/ar6/wg1/)  
    ê¸°ì¤€: 1850~1900ë…„ í‰ê·  ëŒ€ë¹„ ì „ ì§€êµ¬ í‰ê·  ì§€í‘œ ì˜¨ë„(GSAT) ìƒìŠ¹ì¹˜
    """)
    
    # --- IPCC AR6 ì˜ˆì¸¡ ë°ì´í„°í”„ë ˆì„ ìƒì„± ---
    future_data = {
        "ì‹œë‚˜ë¦¬ì˜¤": ["SSP1-1.9", "SSP1-2.6", "SSP2-4.5", "SSP3-7.0", "SSP5-8.5"],
        "ë‹¨ê¸°(2021-2040)": [1.5, 1.5, 1.5, 1.5, 1.6],
        "ì¤‘ê¸°(2041-2060)": [1.6, 1.7, 2.0, 2.1, 2.4],
        "ì¥ê¸°(2081-2100)": [1.4, 1.8, 2.7, 3.6, 4.4]
    }
    df_future = pd.DataFrame(future_data)

    # --- ì‹œê°í™”ë¥¼ ìœ„í•´ melt ë³€í™˜ ---
    df_melt = df_future.melt(id_vars="ì‹œë‚˜ë¦¬ì˜¤", 
                             var_name="ê¸°ê°„", 
                             value_name="ê¸°ì˜¨ ì´ìƒì¹˜(Â°C)")

    # --- Plotly Bar Chart ---
    fig_future = px.bar(
        df_melt, x="ì‹œë‚˜ë¦¬ì˜¤", y="ê¸°ì˜¨ ì´ìƒì¹˜(Â°C)", color="ê¸°ê°„",
        barmode="group",
        title="IPCC AR6 ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¯¸ë˜ ê¸°ì˜¨ ì´ìƒì¹˜ ì˜ˆì¸¡",
        labels={"ì‹œë‚˜ë¦¬ì˜¤": "ë°°ì¶œ ì‹œë‚˜ë¦¬ì˜¤", "ê¸°ì˜¨ ì´ìƒì¹˜(Â°C)": "ê¸°ì˜¨ ì´ìƒì¹˜ (Â°C)"}
    )
    st.plotly_chart(fig_future, use_container_width=True)

    # --- ìš”ì•½ ë©”ì‹œì§€ ---
    st.warning("""
    ğŸ”¹ **ë°°ì¶œëŸ‰ ì–µì œ(SSP1)** â†’ 1.4~1.8Â°C ìˆ˜ì¤€ì—ì„œ ì•ˆì •í™” ê°€ëŠ¥  
    ğŸ”¹ **ì¤‘ê°„ ë°°ì¶œ(SSP2-4.5)** â†’ 21ì„¸ê¸° ë§ 2.7Â°C ìƒìŠ¹ ì˜ˆìƒ  
    ğŸ”¹ **ê³ ë°°ì¶œ(SSP5-8.5)** â†’ ìµœëŒ€ 4.4Â°C ì´ìƒ ìƒìŠ¹ ì „ë§ â†’ ê·¹ë‹¨ì  ê¸°ìƒí˜„ìƒ, í•´ìˆ˜ë©´ ìƒìŠ¹ ìœ„í—˜ ê°€ì¤‘
    """)
